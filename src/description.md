# 轻量级项目版本发布管理工具

## 使用步骤

1. 查看已有项目：`get /project`
2. 如果项目尚未创建，则需要先初始化项目：`post /project/init`。初始化项目时，可以给项目指定一个密钥，后续的版本更新等都要使用该密钥。
3. 初始化项目之后，需要刷新nginx配置，端口才会有效：`post /nginx/reload`
4. 发布新版本：`post /version/release`。发布成功之后，通过端口即可进行访问: `http://{host}:{port}`
5. 如果发布的新版本发现有问题，则可以进行回滚：`post /version/rollback` （注意：目前只支持回滚一次）
6. 如果需要查看项目的历史更新信息，则可以：`post /project/history`
7. 如果项目已经无效，则可以删除：`delete /project`

注意观察接口的返回值信息。

## 接口功能

### 1. 版本管理功能

目前只支持静态网站的部署管理。

#### 1.1 版本发布

- 版本发布时，可以按照项目的模块进行更新，每个项目可以支持多个模块。如果整个项目没法拆分，则在配置时可以只设置为一个模块。
- 在更新的时候，还会进行安全校验。
- 更新包必须满足一定的条件，必须使用tar打包，且只包含一个目录**dist**。
- 配置好之后，nginx会自动将端口路由到dist目录下。
- 支持那些项目和模块，需要这个是管理员配置的，外部无法更改。

说明：在版本更新之前，应该先通过版本更新历史查询接口，确认当前打包的版本是最新的版本。

#### 1.2 版本回滚

版本更新不对，则可以进行版本回滚。

说明：暂时只支持回滚单个版本。

### 2. 项目功能

- 所有项目列表：查看所有已经配置的所有项目的基础信息
- 项目版本更新的历史记录接口：可以获取对应模块的更新历史

### 3. Nginx配置更新功能

请求配置重载接口/nginx/reload
